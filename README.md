<h1 name="content" align="center"><a href=""><img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/></a> MSSQL</h1>

<p align="center">
  <a href="#lab1"><img alt="lab1" src="https://img.shields.io/badge/Lab1-ffb6c1"></a> 
  <a href="#lab2"><img alt="lab2" src="https://img.shields.io/badge/Lab2-ff91a4"></a>
  <a href="#lab3"><img alt="lab3" src="https://img.shields.io/badge/Lab3-ff69b4"></a>
  <a href="#lab4"><img alt="lab4" src="https://img.shields.io/badge/Lab4-ff1493"></a>
  <a href="#lab5"><img alt="lab5" src="https://img.shields.io/badge/Lab5-db7093"></a>
  <a href="#lab6"><img alt="lab6" src="https://img.shields.io/badge/Lab6-c71585"></a> 
  <a href="#lab7"><img alt="lab7" src="https://img.shields.io/badge/Lab7-ffc0cb"></a>
  <a href="#lab8"><img alt="lab8" src="https://img.shields.io/badge/Lab8-d87093"></a>
  <a href="#lab9"><img alt="lab9" src="https://img.shields.io/badge/Lab9-ffb8c9"></a> 
</p>

<img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Аптека (Вариант №15)
<p aligh="justify>
<h3>
  <a href="#client"></a>
  
  Информация о лекарствах: Название лекарства,  показания к применению, аннотация лекарства, производитель, основное действующее вещество, кол-во в данной аптеке, цена за ед., срок годности.
  Продажи: список лекарств и количество каждого лекарства, дата продажи, общая сумма, фамилия касссира.
  Заказы: список лекарств и количество каждого лекарства, сумма заказа, дата заказа.

  Реализовать:
- Вывод прайс-листа по разделам лекарств;
- Поиск лекарства по различным параметрам (название, болезнь, производитель, основное действующее вещество);
- Поиск лекарств от заданной болезни
- Подбор более дешевого лекарства с тем же основным действующим веществом;
- Список наиболее часто покупаемых лекарств;
- Если какое-то лекарство закончилось, то автоматическое занесение его в книгу заказов.
- Поиск лекарств с истекшим сроком годности;
- Посчет выручки аптеки за заданный период
</h3>
</p>

<a id="lab1"></a>
# Лабораторная работа №1
[Назад](#content)


Разработать ER-модель данной предметной области: выделить сущности, их атрибуты, связи между сущностями.
Для каждой сущности указать ее имя, атрибут (или набор атрибутов), являющийся первичным ключом, список остальных атрибутов.
Для каждого атрибута указать его тип, ограничения, может ли он быть пустым, является ли он первичным ключом.
Для каждой связи между сущностями указать:
- тип связи (1:1, 1:M, M:N)
- обязательность
ER-модель д.б. представлена в виде ER-диаграммы (картинка)
По имеющейся ER-модели создать реляционную модель данных и отобразить ее в виде списка сущностей с их атрибутами и типами атрибутов, для атрибутов указать, явл. ли он первичным или внешним ключом


#### ER-модель
![image](/lab1/ER_1.png)

#### Реляционная модель
![image](/lab1/2.png)

<a id="lab2"></a>
# Лабораторная работа №2
[Назад](#content)


В соответствии с реляционной моделью данных, разработанной в Лаб.№1, создать реляционную БД на учебном сервере БД :
- создать таблицы, определить первичные ключи и иные ограничения
- определить связи между таблицами
- создать диаграмму
- заполнить все таблицы адекватной информацией (не меньше 10 записей в таблицах, наличие примеров для связей типа 1:M )


[SQL-код создания таблиц](https://github.com/rrakhimovva/db_labs/blob/main/lab2/SQLQuery1.sql)

#### Диаграмма базы данных
![image](/lab1/diagram_bd.jpg)

<a id="lab3"></a>
# Лабораторная работа №3
[Назад](#content)

Цель: изучить конструкции языка SQL для манипулирования данными в СУБД  MSSQL.

Краткое описание работы:
1. Выборка из одной таблицы
2. Выборка из нескольких таблиц
3. Представления
4. Функции ранжирования
5. Объдинение, пересечение, разность
6. Использование CASE, PIVOT и UNPIVOT

[Часть 1](https://github.com/rrakhimovva/db_labs/blob/main/lab3/Рахимова_ПМИ32_часть1.docx)

[Часть 2](https://github.com/rrakhimovva/db_labs/blob/main/lab3/Рахимова_ПМИ32_часть2.docx)

<a id="lab4"></a>
# Лабораторная работа №4
[Назад](#content)

Создать 4 различных хранимых процедуры:
a) Процедура без параметров, формирующая список лекарств, для которых срок годности заканчивается меньше, чем через 1 месяц
b) Процедура, на входе получающая название основного действующего вещества и формирующая список лекарств с этим действующим веществом, упорядоченный по возрастанию цены в виде: название лекарства, цена, производитель
c) Процедура, на входе получающая название лекарства, выходной параметр – самый дешевый его аналог с тем же действующим веществом
d) Процедура, вызывающая вложенную процедуру, которая подсчитывает среднее количество наименований лекарств для одной продажи, а сама выводит продажи с количеством лекарств, превышающим среднее в виде: номер продажи, дата, сумма, кассир
	
Создать 3 пользовательских функции:
a) Скалярная функция, возвращающая выручку аптеки на заданную дату
b) Inline-функция, возвращающая список лекарств и их количество, проданных на заданную дату
c) Multi-statement-функция, выдающая список лекарств от заданной болезни, имеющихся в аптеке с указанием количества упаковок
	
Создать 3 триггера:
a) Триггер любого типа на добавление лекарства в заказ: при добавлении нового лекарства проверить, сформирован ли уже заказ на сегодня, если нет, то создать новый заказ на текущую дату и добавить туда лекарство. Если на сегодня заказ есть, то лекарство добавляется к нему
b)  Последующий триггер на изменение количества лекарства в аптеке – если количество упаковок лекарства < 3, формируем строку с заказом на это лекарство
c) Замещающий триггер на операцию удаления лекарства из списка купленных покупателем лекарств – если покупатель передумал покупать только что купленное лекарство, то выполняем операцию возврата (удаляем это лекарство из списка купленных этим покупателем лекарств, возвращаем его в аптеку, пересчитываем сумму чека для покупателя)
